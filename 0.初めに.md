# ガスポータルBackEnd (レイヤードアーキテクチャ)

## 勉強会の背景
- NestJs & レイヤードアーキテクチャの実際2ヶ月くらい実装して感じたこと
- ガスポータルBackEnd実装について共有
- 先発隊
- 時期と優先順位考慮

## 伝えたいこと
- 全部理解出来なくても大丈夫
- 理解してから実装より、実装しながら理解でも大丈夫
- Module一つ実装してみると分かるようになる
- 心配しなくてもいい
- abeさんの実装例とドキュメントがすごく参考になりました。

## ガスポータルBackEnd技術キーワード
- NestJS
- TypeScript
- レイヤードアーキテクチャ
- Prisma
- Swagger (OpenAPI)

## レイヤードアーキテクチャ実装について

> メリット
- Typescriptの恩恵
  - コードの整合性を守れる (コードレベルのバグを予防できる)
  - 変数の型が明確
  - 関数の引数と戻り値が明確
- DTOの活用
  - requestとresponseをobjectで管理できる
  - validation処理が書きやすくなる
- レイヤーごとの責務分担
  - 責務が分かりやすい
  - コードが複雑にならない
  - データの流れが追いやすい

> デメリット
- 求められる知識が多い
  - Typescript、NestJs、OpenApi、Swagger、Prisma
  - 各責務の理解
- コード量が多い
  - 定義が多い type、interface、class、yaml
  - レイヤーによってはデータのマ変換が必要
- 修正に時間がかかる (戻りが大変)
  - ファイルごと依存関係が多い

## 実装で困ったところ
> どこから実装すべきか
- 様々なフォルダの中、どのファイルから作ればいい?
> UseCaseのカテゴライズ (Module分離)
- どの観点からModuleを分ければいいのか
- あのModuleまだないのに
> Bigint
- TypescriptのnumberタイプはBigintに対応しない
- DBのBigintはStringで変換して扱う
> 命名に悩む
- action + target + role + ts?
- 複数? 単数?

## レイヤードアーキテクチャなしでNestJSのみでは?
- Typescriptのメリットもそのまま
- NestJsのModule単位でもある程度管理できる
- Module管理でも人により書き方が守られない可能性がある

## cursorは使えるか
- 使えなかったら実装工数2倍
- 参考できるファイルやパスがあれば任せる
- Swagger作業任せる

## lintの恩恵が大きい
- コマンドを叩くことで、コードが綺麗になる
- 定義して使われてない部分が指摘される

## 前回の関連資料
- Swagger OpenAPI
- NestJs 基礎

## todo add
- tokenの役割
- cache説明